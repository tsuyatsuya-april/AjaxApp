{"ast":null,"code":"function check() {\n  var posts = document.getElementsByClassName(\"post\");\n  postsA = Array.from(posts);\n  postsA.forEach(function (post) {\n    if (post.getAttribute(\"data-load\") != null) {\n      return null;\n    }\n\n    post.setAttribute(\"data-load\", \"true\");\n    post.addEventListener(\"click\", function (e) {\n      var postId = post.getAttribute(\"data-id\");\n      var XHR = new XMLHttpRequest();\n      XHR.open(\"GET\", \"/posts/\".concat(postId), true);\n      XHR.responseType = \"json\";\n      XHR.send();\n\n      XHR.onload = function () {\n        var item = XHR.response.post;\n\n        if (item.checked === true) {\n          post.setAttribute(\"data-check\", \"true\");\n        } else if (item.checked === false) {\n          post.removeAttribute(\"data-check\");\n        }\n\n        if (XHR.status != 200) {\n          alert(\"Error \".concat(XHR.status, \": \").concat(XHR.statusText));\n        } else {\n          return null;\n        }\n      };\n\n      XHR.onerror = function () {\n        alert(\"Request failed\");\n      };\n\n      e.preventDefault();\n    });\n  });\n}\n\nsetInterval(check, 1000); // window.addEventListener(\"load\", check);","map":{"version":3,"sources":["/Users/numatatetsuya/projects/AjaxApp/app/javascript/checked.js"],"names":["check","posts","document","getElementsByClassName","postsA","Array","from","forEach","post","getAttribute","setAttribute","addEventListener","e","postId","XHR","XMLHttpRequest","open","responseType","send","onload","item","response","checked","removeAttribute","status","alert","statusText","onerror","preventDefault","setInterval"],"mappings":"AAAA,SAASA,KAAT,GAAiB;AACf,MAAMC,KAAK,GAAGC,QAAQ,CAACC,sBAAT,CAAgC,MAAhC,CAAd;AACAC,EAAAA,MAAM,GAAGC,KAAK,CAACC,IAAN,CAAWL,KAAX,CAAT;AACAG,EAAAA,MAAM,CAACG,OAAP,CAAe,UAAUC,IAAV,EAAe;AAC5B,QAAIA,IAAI,CAACC,YAAL,CAAkB,WAAlB,KAAkC,IAAtC,EAA4C;AAC1C,aAAO,IAAP;AACD;;AACDD,IAAAA,IAAI,CAACE,YAAL,CAAkB,WAAlB,EAA+B,MAA/B;AACAF,IAAAA,IAAI,CAACG,gBAAL,CAAsB,OAAtB,EAA+B,UAACC,CAAD,EAAO;AACpC,UAAMC,MAAM,GAAGL,IAAI,CAACC,YAAL,CAAkB,SAAlB,CAAf;AACA,UAAMK,GAAG,GAAG,IAAIC,cAAJ,EAAZ;AACAD,MAAAA,GAAG,CAACE,IAAJ,CAAS,KAAT,mBAA0BH,MAA1B,GAAoC,IAApC;AACAC,MAAAA,GAAG,CAACG,YAAJ,GAAmB,MAAnB;AACAH,MAAAA,GAAG,CAACI,IAAJ;;AACAJ,MAAAA,GAAG,CAACK,MAAJ,GAAa,YAAM;AACjB,YAAMC,IAAI,GAAGN,GAAG,CAACO,QAAJ,CAAab,IAA1B;;AACA,YAAIY,IAAI,CAACE,OAAL,KAAiB,IAArB,EAA2B;AACzBd,UAAAA,IAAI,CAACE,YAAL,CAAkB,YAAlB,EAAgC,MAAhC;AACD,SAFD,MAEO,IAAIU,IAAI,CAACE,OAAL,KAAiB,KAArB,EAA4B;AACjCd,UAAAA,IAAI,CAACe,eAAL,CAAqB,YAArB;AACD;;AACD,YAAIT,GAAG,CAACU,MAAJ,IAAc,GAAlB,EAAuB;AACrBC,UAAAA,KAAK,iBAAUX,GAAG,CAACU,MAAd,eAAyBV,GAAG,CAACY,UAA7B,EAAL;AACD,SAFD,MAEO;AACL,iBAAO,IAAP;AACD;AACF,OAZD;;AAaAZ,MAAAA,GAAG,CAACa,OAAJ,GAAc,YAAM;AAClBF,QAAAA,KAAK,CAAC,gBAAD,CAAL;AACD,OAFD;;AAIAb,MAAAA,CAAC,CAACgB,cAAF;AACD,KAxBD;AAyBD,GA9BD;AA+BD;;AAEDC,WAAW,CAAC7B,KAAD,EAAQ,IAAR,CAAX,C,CACA","sourcesContent":["function check() {\n  const posts = document.getElementsByClassName(\"post\");\n  postsA = Array.from(posts);\n  postsA.forEach(function (post){ \n    if (post.getAttribute(\"data-load\") != null) {\n      return null;\n    }\n    post.setAttribute(\"data-load\", \"true\");\n    post.addEventListener(\"click\", (e) => {\n      const postId = post.getAttribute(\"data-id\");\n      const XHR = new XMLHttpRequest();\n      XHR.open(\"GET\", `/posts/${postId}`, true);\n      XHR.responseType = \"json\";\n      XHR.send();\n      XHR.onload = () => {\n        const item = XHR.response.post;\n        if (item.checked === true) {\n          post.setAttribute(\"data-check\", \"true\");\n        } else if (item.checked === false) {\n          post.removeAttribute(\"data-check\");\n        }\n        if (XHR.status != 200) {\n          alert(`Error ${XHR.status}: ${XHR.statusText}`);\n        } else {\n          return null;\n        }\n      }\n      XHR.onerror = () => {\n        alert(\"Request failed\");\n      };\n\n      e.preventDefault()\n    });\n  });\n}\n\nsetInterval(check, 1000);\n// window.addEventListener(\"load\", check);\n"]},"metadata":{},"sourceType":"module"}